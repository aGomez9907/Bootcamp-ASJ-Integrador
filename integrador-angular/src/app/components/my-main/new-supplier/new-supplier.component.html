<section class="row">
  <div class="row">
    <div class="col">
      <a class="text-decoration-none" routerLink="/suppliers">‚Üê Back to list</a>
    </div>
  </div>
  <div class="text-center my-4">
    <h1 *ngIf="!isUpdating">Add new supplier</h1>
    <h1 *ngIf="isUpdating">Update supplier</h1>
  </div>
  <hr />
  <form #suppliersForm="ngForm" (ngSubmit)="saveSupplier()" class="row">
    <div class="col-4">
      <label for="id-proveedor" class="col-sm-4 col-form-label text-start"
        >Supplier code <span class="fw-light">*</span></label
      >
      <input
        type="text"
        class="form-control"
        id="id-proveedor"
        required=""
        minlength="4"
        name="code"
        #code="ngModel"
        [(ngModel)]="currentSupplier.codProv"
        placeholder="Supplier code"
      />
       <div *ngIf="code.errors?.['minlength']" class="col-auto">
        <span class="form-text text-danger"
          >Must have at least 4 characters.</span
        >
      </div> 
    </div>

    <div class="col-4">
      <label for="razon-social" class="col-sm-4 col-form-label text-start"
        >Supplier name <span class="fw-light">*</span></label
      >
      <input
        type="text"
        class="form-control"
        id="razon-social"
        name="legalName"
        #legalName="ngModel"
        required=""
        [(ngModel)]="currentSupplier.legalName"
        placeholder="Legal name"
      />
    </div>

    <div class="col-4">
      <div class="row">
        <div class="col-8">
          <label
            for="select-category"
            class="col-sm-4 col-form-label text-start"
            >Category</label
          >
        </div>
        <div class="col-4">
          <button
            class="btn btn-outline-primary btn-sm"
            type="button"
            (click)="createNewCategory()"
          >
            <i class="rounded-circle">Add category</i>
          </button>
        </div>
      </div>

      <select
        class="form-select"
        id="select-category"
        name="category"
        #category="ngModel"
        [(ngModel)]="currentSupplier.categoryId.id"
      >
      <option disabled selected value="0">Select a category</option>
        <option *ngFor="let c of categories" value="{{c.id}}">
          {{ c.name }}
        </option>
      </select>
    </div>

    <div class="col-4">
      <label for="input-web" class="col-sm-4 col-form-label text-start"
        >Website</label
      >
      <input
        type="text"
        class="form-control"
        id="input-web"
        name="website"
        #website="ngModel"
        [(ngModel)]="currentSupplier.webSite"
        placeholder="www.example.com"
      />
    </div>

    <div class="col-4">
      <label for="input-tel" class="col-sm-4 col-form-label text-start"
        >Phone</label
      >
      <div class="row">
        <div class="col-3">
          <input
            type="text"
            class="form-control"
            id="input-tel-country"
            name="phoneCountry"
            #phoneCountry="ngModel"
            [(ngModel)]="currentSupplier.phoneId.country"
            placeholder="+1"
          
          />
        </div>
        <div class="col-9">
          <input
            type="number"
            class="form-control"
            id="input-tel"
            name="phone"
            #phoneNumber="ngModel"
            [(ngModel)]="currentSupplier.phoneId.phoneNumber"
            placeholder="123456789"
            
          />
        </div>
      </div>
      <div *ngIf="showbadCountryCode1" class="error-message">Country code must be numeric.</div>
    </div>

    <div class="col-4">
      <label for="input-email" class="col-sm-4 col-form-label text-start"
        >Email</label
      >
      <input
        type="email"
        class="form-control"
        id="input-email"
        name="email"
        #email="ngModel"
        [(ngModel)]="currentSupplier.email"
        placeholder="someone@example.com"
      />
    </div>

    <h4 class="mt-3">Address</h4>
    <hr />
    <div class="col-4">
      <label for="input-calle" class="col-sm-4 col-form-label text-start"
        >Street</label
      >
      <input
        type="text"
        class="form-control"
        id="input-calle"
        required=""
        name="street"
        #street="ngModel"
        [(ngModel)]="currentSupplier.addressId.street"
        placeholder="Street"
      />
    </div>

    <div class="col-4">
      <label for="input-numero" class="col-sm-4 col-form-label text-start"
        >Number</label
      >
      <input
        type="text"
        class="form-control"
        id="input-calle"
        required=""
        name="number"
        #number="ngModel"
        [(ngModel)]="currentSupplier.addressId.number"
        placeholder="123"
      />
    </div>

    <div class="col-4">
      <label for="input-cp" class="col-sm-4 col-form-label text-start"
        >Post Code</label
      >
      <input
        type="text"
        class="form-control"
        id="input-cp"
        name="postCode"
        #postCode="ngModel"
        [(ngModel)]="currentSupplier.addressId.postcode"
        placeholder="1234"
      />
    </div>

    <div class="col-4">
      <label for="country" class="col-sm-4 col-form-label text-start"
        >Country</label
      >
      <select
        class="form-select"
        id="country"
        name="country"
        #country="ngModel"
        [(ngModel)]="currentSupplier.addressId.provinceId.countryId.id"
        (change)="onSelectCountry($event)"
      >
      <option disabled selected value="0">Select a country</option>
        <option *ngFor="let country of countries" value="{{country.id}}">
          {{ country.name }}
        </option>
      </select>
    </div>

    <div class="col-4">
      <label for="province" class="col-sm-4 col-form-label text-start"
        >Province</label
      >
      <select
        class="form-select"
        name="provincia"
        id="province"
        #province="ngModel"
        [(ngModel)]="currentSupplier.addressId.provinceId.id"
      >
      <option disabled selected value="0">Select a province</option>
        <option
          *ngFor="let province of provincesToShow" value="{{province.id}}"
        >
          {{ province.name }}
        </option>
      </select>
    </div>

    <div class="col-4">
      <label for="city" class="col-sm-4 col-form-label text-start">City</label>
      <input
        class="form-control"
        name="city"
        id="city"
        #province="ngModel"
        [(ngModel)]="currentSupplier.addressId.city"
        placeholder="City"
      >
        
     
    </div>

    <h4 class="mt-3">Tax information</h4>
    <hr />
    <div class="col-6">
      <label for="input-cuit" class="col-sm-4 col-form-label text-start"
        >CUIT</label
      >
      <input
        type="text"
        class="form-control"
        id="input-cuit"
        name="cuit"
        #cuit="ngModel"
        [(ngModel)]="currentSupplier.cuit"
        appCuitFormat
        placeholder="01-23456789-1"
      />
    </div>

    <div class="col-6">
      <label for="select-iva" class="col-sm-4 col-form-label text-start"
        >IVA</label
      >
      <select
        class="form-select"
        id="select-iva"
        name="iva"
        #iva="ngModel"
        [(ngModel)]="currentSupplier.taxConditionId.id"
      >
      <option disabled selected value="0">Select a IVA</option>
        <option *ngFor="let i of ivas" value="{{i.id}}">
          {{ i.name }}
        </option>
        <option value="Proveedor del Exterior">Proveedor del Exterior</option>
      </select>
    </div>

    <h4 class="mt-3">Contact information</h4>
    <hr />
    <div class="col-4">
      <label for="nombre-contacto" class="col-sm-4 col-form-label text-start"
        >Contact first name</label
      >
      <input
        type="text"
        class="form-control"
        id="nombre-contacto"
        name="contactFirstName"
        #contactFirstName="ngModel"
        [(ngModel)]="currentSupplier.contactInfoId.firstName"
        placeholder="First name"
      />
    </div>

    <div class="col-4">
      <label for="apellido-contacto" class="col-sm-4 col-form-label text-start"
        >Contact last name</label
      >
      <input
        type="text"
        class="form-control"
        id="apellido-contacto"
        name="contactLasttName"
        #contactLasttName="ngModel"
        [(ngModel)]="currentSupplier.contactInfoId.lastName"
        placeholder="Last name"
      />
    </div>
    <div class="col-4">
      <label for="rol-contacto" class="col-sm-4 col-form-label text-start"
        >Contact role</label
      >
      <input
        type="text"
        class="form-control"
        id="rol-contacto"
        name="contactRole"
        #contactRole="ngModel"
        [(ngModel)]="currentSupplier.contactInfoId.contactRole"
        placeholder="Role"
      />
    </div>

    <div class="col-6">
      <label for="telefono-contacto" class="col-sm-4 col-form-label text-start"
        >Contact phone</label
      >
      <div class="row">
        <div class="col-3">
          <input
            type="text"
            class="form-control"
            id="telefono-contacto"
            name="contactPhoneCountry"
            #contactPhoneCountry="ngModel"
            [(ngModel)]="currentSupplier.contactInfoId.phoneId.country"
            placeholder="+1"
            
          />
        </div>
        <div class="col-9">
          <input
            type="number"
            class="form-control"
            id="telefono-contacto"
            name="contactPhoneNumber"
            #contactPhoneNumber="ngModel"
            [(ngModel)]="currentSupplier.contactInfoId.phoneId.phoneNumber"
            placeholder="123456789"
          />
        </div>
      </div>
      <div *ngIf="showbadCountryCode2" class="error-message">Country code must be numeric.</div>
    </div>

    <div class="col-6">
      <label for="email-contacto" class="col-sm-4 col-form-label text-start"
        >Contact email</label
      >
      <input
        type="email"
        class="form-control"
        id="email-contacto"
        name="contactEmail"
        #contactEmail="ngModel"
        [(ngModel)]="currentSupplier.contactInfoId.email"
        placeholder="someone@example.com"
      />
    </div>

    <div class="modal-footer mt-2">
      <button type="button" class="btn btn-secondary">Cancel</button>
      <button
        type="submit"
        class="btn btn-primary"
        id="guardar-proveedor"
        [disabled]="!suppliersForm.valid"
      >
        Save
      </button>
    </div>
  </form>
</section>
